/*! LUN-Minifig-Wizard v1.2.9 | 2013-2015 Caleb Ely & rioforce | MIT */
!function(a){"use strict";function b(a){i.empty(),e.curImages=[];var b={name:e.curPartName,size:e.size,images:a[e.curPartName],number:a[e.curPartName].length,curPart:e.curPartIDs[e.curPartName]};o.postMessage(b),o.onmessage=function(a){i.html(a.data.table),e.curImages=a.data.fullsize,window.Worker.notNative&&o.terminate()},4===e.size&&b.number>16||6===e.size&&b.number>24?(f.perfectScrollbar({wheelSpeed:1,suppressScrollX:!0}),f.perfectScrollbar("update")):f.perfectScrollbar("destroy")}function c(){return a.ajax({type:"GET",cache:!0,url:"img/images.json",dataType:"json"})}function d(a){if(e.curPartName=a,window.localStorage.hasOwnProperty("images")){var d=JSON.parse(window.localStorage.getItem("images")),f=d.version.split("."),g=document.LUN.version.split(".");g[0]===f[0]&&g[1]===f[1]?b(d):(g[0]>f[0]||g[1]>f[1])&&c().success(function(a){window.localStorage.setItem("images",JSON.stringify(a)),b(a)})}else c().success(function(a){window.localStorage.setItem("images",JSON.stringify(a)),b(a)})}var e={size:4,curImages:[],curPartName:null,curPartIDs:{hat:null,leg:null,head:null,torso:null,sword:null,shield:null},minifigParts:{hat:document.LUN.getVariable("imgHat"),leg:document.LUN.getVariable("imgLeg"),head:document.LUN.getVariable("imgHead"),torso:document.LUN.getVariable("imgTorso"),sword:document.LUN.getVariable("imgSword"),shield:document.LUN.getVariable("imgShield")}},f=a(document.LUN.getVariable("buildArea")),g=a(document.LUN.getVariable("background")),h=a(document.LUN.getVariable("buttonResize")),i=a(document.LUN.getVariable("minifigItems")),j=a(document.LUN.getVariable("buttonNewWindow")),k=a(document.LUN.getVariable("areaMinifigParts")),l=a(document.LUN.getVariable("categoryButtonsTh")),m=a(document.LUN.getVariable("categoryButtonsDiv")),n=a(document.LUN.getVariable("categoryButtonsImg")),o=new Worker("js/workers/table-gen.min.js");j.on("click",function(){var a=document.LUN.encodeQuery();return a&&window.open("window.html"+a,"LUNMinifigWizard","width=600, height=600"),!0}),i.on("click",function(b){if("img"!==b.target.localName.toLowerCase())return!1;var c=a(b.target).parent().attr("id"),d="#"+c;e.curPartIDs[e.curPartName]=d;var f=e.minifigParts[e.curPartName],g=a(d);g.hasClass("selected")||(a(".selector").removeClass("selected"),g.addClass("selected"));var h=c.match(/^\w+?-(\d+)$/)[1];return a(f).attr("src",e.curImages[h]),!0}),n.on("click",function(){return n.removeClass("bubble active"),a(this).addClass("bubble active"),d(a(this).attr("id")),!0}),h.on("click",function(){4===e.size?(e.size=6,Modernizr.csstransitions?(h.css("transform","translate3d(190px, 0, 0)"),k.css("width","+=180px"),g.css("width","+=180px"),m.css("margin-left","+=48px"),l.css("padding-left","5px"),l.css("padding-right","5px"),f.css("width","+=180px")):(h.animate({left:"+=190px"},300),k.animate({width:"+=180px"},300),g.animate({width:"+=180px"},300),m.animate({"margin-left":"+=48px"},300),l.animate({"padding-left":"5px"},100),l.animate({"padding-right":"5px"},100),f.animate({width:"+=180px"},150)),i.css("margin-left","20px"),h.attr("src","img/ui/Reduce-button.svg")):(e.size=4,Modernizr.csstransitions?(h.css("transform",""),k.css("width",""),g.css("width",""),m.css("margin-left",""),l.css("padding-left",""),l.css("padding-right",""),f.css("width","-=180px")):(h.animate({left:"-=190px"},300),k.animate({width:"-=180px"},300),g.animate({width:"-=180px"},300),m.animate({"margin-left":"-=48px"},300),l.animate({"padding-left":"0px"},100),l.animate({"padding-right":"0px"},100),f.animate({width:"-=180px"},150)),i.css("margin-left","5px"),h.attr("src","img/ui/Enlarge-button.svg")),d(e.curPartName)}),a(function(){return a("#emmet").on("click",function(){var b=a(document.LUN.getVariable("imgSpecial"));b.attr("src").indexOf("empty")>-1?b.attr("src","img/special/Special001.png"):b.attr("src","img/spark/empty.png")}),d("head"),!0})}(jQuery);